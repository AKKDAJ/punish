<!DOCTYPE html>
<html lang="zh-Hant">

<head>
    <meta charset="UTF-8" />
    <title>æ‡²è™•ç³»çµ± Punishment System</title>
    <style>
        body {
            background: #1e1e1e;
            color: white;
            font-family: Arial;
            padding: 20px;
        }

        .hidden {
            display: none;
        }

        .section {
            background: #2e2e2e;
            padding: 15px;
            margin: 10px 0;
            border-radius: 10px;
        }

        input,
        button {
            padding: 8px;
            margin: 5px 0;
            border-radius: 6px;
        }

        .record {
            background: #444;
            padding: 10px;
            border-radius: 6px;
            margin-bottom: 5px;
        }

        #logoutBtn {
            float: right;
        }

        select {
            margin-left: 10px;
        }
    </style>
</head>

<body>

    <div id="loginSection" class="section">
        <h2>ğŸ” <span data-i18n="login_title">å¾Œå°ç™»å…¥</span></h2>
        <input id="loginUser" placeholder="å¸³è™Ÿ / Username"><br>
        <input id="loginPass" type="password" placeholder="å¯†ç¢¼ / Password"><br>
        <button onclick="login()"><span data-i18n="login_btn">ç™»å…¥</span></button>
    </div>

    <div id="mainSection" class="hidden">
        <h2>ğŸ® <span data-i18n="system_title">æ‡²è™•ç³»çµ±</span>
            <button id="logoutBtn" onclick="logout()">ğŸšª <span data-i18n="logout_btn">ç™»å‡º</span></button>
            <select onchange="switchLang(this.value)">
                <option value="zh">ä¸­æ–‡</option>
                <option value="en">English</option>
            </select>
        </h2>

        <div class="section">
            <h3>â• <span data-i18n="add_player">æ–°å¢ç©å®¶</span></h3>
            <input id="playerId" placeholder="ç©å®¶ ID">
            <input id="playerName" placeholder="ç©å®¶åç¨±">
            <button onclick="addPlayer()"><span data-i18n="add_btn">æ–°å¢</span></button>
        </div>

        <div class="section">
            <h3>ğŸš« <span data-i18n="punish_player">æ‡²è™•ç©å®¶</span></h3>
            <input id="punishId" placeholder="ç©å®¶ ID">
            <input id="punishReason" placeholder="åŸå› ">
            <input id="punishDays" placeholder="å¤©æ•¸ (å¹¾å¤©å¾Œè‡ªå‹•è§£å°)" type="number">
            <button onclick="punishPlayer()"><span data-i18n="punish_btn">åŸ·è¡Œæ‡²è™•</span></button>
        </div>

        <div class="section">
            <h3>ğŸ“œ <span data-i18n="view_record">æŸ¥è©¢ç´€éŒ„</span></h3>
            <input id="searchId" placeholder="ç©å®¶ ID">
            <button onclick="showRecord()"><span data-i18n="view_btn">æŸ¥è©¢</span></button>
            <div id="recordArea"></div>
        </div>

        <div class="section">
            <h3>ğŸ“Š <span data-i18n="rank_title">æ‡²è™•æ’è¡Œæ¦œ</span></h3>
            <div id="rankArea"></div>
        </div>

        <!-- æ“æœ‰è€…å°ˆå±¬ UI -->
        <div id="ownerSection" class="hidden section" style="display: flex; gap: 20px;">
            <div style="flex: 1;">
                <h3 data-i18n="owner_log">ğŸ“ æ—¥èªŒ</h3>
                <div id="logArea" style="background:#333;padding:10px;border-radius:6px;"></div>
            </div>
            <div style="flex: 1;">
                <h3 data-i18n="owner_manage">ğŸ§‘â€âš–ï¸ é•è¦ç®¡ç†</h3>
                <input id="delPunishId" placeholder="ç©å®¶ ID">
                <button onclick="deletePunishment()" data-i18n="delete_punish_btn">âŒ åˆªé™¤é•è¦ç´€éŒ„</button>
            </div>
            <div style="flex: 1;">
                <h3 data-i18n="owner_admin">ğŸ‘¤ ç®¡ç†å“¡ç®¡ç†</h3>
                <input id="newAdminId" placeholder="å¸³è™Ÿ">
                <input id="newAdminPwd" placeholder="å¯†ç¢¼">
                <button onclick="addAdmin()" data-i18n="add_admin_btn">âœ… æ–°å¢ç®¡ç†å“¡</button><br>
                <input id="delAdminId" placeholder="è¦åˆªé™¤çš„å¸³è™Ÿ">
                <button onclick="deleteAdmin()" data-i18n="delete_admin_btn">âŒ åˆªé™¤ç®¡ç†å“¡</button>
            </div>
        </div>

    </div>

    <script>
        const accounts = {
            "admin1": { password: "123321aZ", role: "admin" },
            "pop1": { password: "pop1", role: "owner" }
        };

        const i18n = {
            zh: {
                login_title: "å¾Œå°ç™»å…¥",
                login_btn: "ç™»å…¥",
                logout_btn: "ç™»å‡º",
                system_title: "æ‡²è™•ç³»çµ±",
                add_player: "æ–°å¢ç©å®¶",
                add_btn: "æ–°å¢",
                punish_player: "æ‡²è™•ç©å®¶",
                punish_btn: "åŸ·è¡Œæ‡²è™•",
                view_record: "æŸ¥è©¢ç´€éŒ„",
                view_btn: "æŸ¥è©¢",
                rank_title: "æ‡²è™•æ’è¡Œæ¦œ",
                owner_log: "ğŸ“ æ—¥èªŒ",
                owner_manage: "ğŸ§‘â€âš–ï¸ é•è¦ç®¡ç†",
                delete_punish_btn: "âŒ åˆªé™¤é•è¦ç´€éŒ„",
                owner_admin: "ğŸ‘¤ ç®¡ç†å“¡ç®¡ç†",
                add_admin_btn: "âœ… æ–°å¢ç®¡ç†å“¡",
                delete_admin_btn: "âŒ åˆªé™¤ç®¡ç†å“¡"
            },
            en: {
                login_title: "Admin Login",
                login_btn: "Login",
                logout_btn: "Logout",
                system_title: "Punishment System",
                add_player: "Add Player",
                add_btn: "Add",
                punish_player: "Punish Player",
                punish_btn: "Punish",
                view_record: "View Records",
                view_btn: "Search",
                rank_title: "Punishment Leaderboard",
                owner_log: "ğŸ“ Log",
                owner_manage: "ğŸ§‘â€âš–ï¸ Punishment Management",
                delete_punish_btn: "âŒ Delete Punishments",
                owner_admin: "ğŸ‘¤ Admin Management",
                add_admin_btn: "âœ… Add Admin",
                delete_admin_btn: "âŒ Delete Admin"
            }
        };

        let currentLang = "zh";
        let currentRole = null;

        function switchLang(lang) {
            currentLang = lang;
            document.querySelectorAll("[data-i18n]").forEach(el => {
                const key = el.getAttribute("data-i18n");
                if (i18n[lang] && i18n[lang][key]) {
                    el.textContent = i18n[lang][key];
                }
            });
        }

        function login() {
            const user = document.getElementById('loginUser').value;
            const pass = document.getElementById('loginPass').value;
            if (accounts[user] && accounts[user].password === pass) {
                currentRole = accounts[user].role;
                document.getElementById('loginSection').classList.add('hidden');
                document.getElementById('mainSection').classList.remove('hidden');
                if (currentRole === "owner") {
                    document.getElementById('ownerSection').classList.remove('hidden');
                }
                loadRank();
            } else {
                alert("ç™»å…¥å¤±æ•— / Login failed");
            }
        }

        function logout() {
            currentRole = null;
            document.getElementById('mainSection').classList.add('hidden');
            document.getElementById('ownerSection').classList.add('hidden');
            document.getElementById('loginSection').classList.remove('hidden');
        }

        function getData() {
            return JSON.parse(localStorage.getItem("players") || "{}");
        }

        function saveData(data) {
            localStorage.setItem("players", JSON.stringify(data));
        }

        function addPlayer() {
            const id = document.getElementById('playerId').value;
            const name = document.getElementById('playerName').value;
            const data = getData();
            if (data[id]) return alert("ç©å®¶å·²å­˜åœ¨");
            data[id] = { name, punishments: [] };
            saveData(data);
            alert("å·²æ–°å¢ç©å®¶");
            loadRank();
        }

        function punishPlayer() {
            const id = document.getElementById('punishId').value;
            const reason = document.getElementById('punishReason').value;
            const days = parseInt(document.getElementById('punishDays').value || "0");
            const data = getData();
            if (!data[id]) return alert("æ‰¾ä¸åˆ°ç©å®¶");
            data[id].punishments.push({
                reason,
                start: Date.now(),
                days
            });
            saveData(data);
            alert("æ‡²è™•å·²è¨˜éŒ„");
            loadRank();
        }

        function showRecord() {
            const id = document.getElementById('searchId').value;
            const area = document.getElementById('recordArea');
            const data = getData();
            area.innerHTML = "";
            if (!data[id]) {
                area.innerHTML = "<p>âŒ æ‰¾ä¸åˆ°ç©å®¶ã€‚</p>";
                return;
            }
            const player = data[id];
            area.innerHTML += `<h4>${player.name}ï¼ˆID: ${id}ï¼‰</h4>`;
            if (player.punishments.length === 0) {
                area.innerHTML += "<p>âœ… ç„¡æ‡²è™•ç´€éŒ„</p>";
            } else {
                player.punishments.forEach((p, i) => {
                    const end = p.start + p.days * 86400000;
                    const isActive = Date.now() < end;
                    area.innerHTML += `
            <div class="record">
              <strong>${i + 1}. </strong>
              <span>åŸå› ï¼š</span>${p.reason}<br>
              <span>èµ·å§‹ï¼š</span>${new Date(p.start).toLocaleString()}<br>
              <span>å¤©æ•¸ï¼š</span>${p.days} å¤©<br>
              <span>ç‹€æ…‹ï¼š</span>${isActive ? "â³ æ‡²è™•ä¸­" : "âœ… å·²è§£å°"}
            </div>`;
                });
            }
        }

        function loadRank() {
            const data = getData();
            const rankArea = document.getElementById('rankArea');
            const ranking = Object.entries(data).map(([id, p]) => ({
                id,
                name: p.name,
                count: p.punishments.length
            })).sort((a, b) => b.count - a.count);
            rankArea.innerHTML = ranking.map((r, i) =>
                `<p>${i + 1}. ${r.name}ï¼ˆID: ${r.id}ï¼‰ - ${r.count} æ¬¡</p>`
            ).join("");
        }

        // æ“æœ‰è€…å°ˆç”¨ï¼šåˆªé™¤é•è¦ç´€éŒ„
        function deletePunishment() {
            const id = document.getElementById('delPunishId').value;
            const data = getData();
            if (!data[id]) return alert("æ‰¾ä¸åˆ°ç©å®¶");
            delete data[id];
            saveData(data);
            alert("å·²åˆªé™¤è©²ç©å®¶çš„æ‰€æœ‰é•è¦ç´€éŒ„");
            loadRank();
        }

        // æ“æœ‰è€…å°ˆç”¨ï¼šæ–°å¢ç®¡ç†å“¡
        function addAdmin() {
            const newAdminId = document.getElementById('newAdminId').value.trim();
            const newAdminPwd = document.getElementById('newAdminPwd').value.trim();
            if (!newAdminId || !newAdminPwd) return alert("è«‹è¼¸å…¥å¸³è™Ÿèˆ‡å¯†ç¢¼");
            if (accounts[newAdminId]) return alert("å¸³è™Ÿå·²å­˜åœ¨");
            accounts[newAdminId] = { password: newAdminPwd, role: "admin" };
            alert("æ–°å¢ç®¡ç†å“¡æˆåŠŸ");
        }

        // æ“æœ‰è€…å°ˆç”¨ï¼šåˆªé™¤ç®¡ç†å“¡
        function deleteAdmin() {
            const delAdminId = document.getElementById('delAdminId').value.trim();
            if (delAdminId === "pop1") return alert("ç„¡æ³•åˆªé™¤æ“æœ‰è€…å¸³è™Ÿ");
            if (!accounts[delAdminId]) return alert("æ‰¾ä¸åˆ°è©²ç®¡ç†å“¡å¸³è™Ÿ");
            delete accounts[delAdminId];
            alert("åˆªé™¤ç®¡ç†å“¡æˆåŠŸ");
        }

        // é é¢åˆå§‹åŒ–
        switchLang(currentLang);
    </script>
</body>

</html>
